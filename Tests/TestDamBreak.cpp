#include <catch2/catch_test_macros.hpp>
#include <catch2/generators/catch_generators.hpp>
#include <catch2/matchers/catch_matchers_floating_point.hpp>
#include <iostream>
#include <random>

#include "Blocks/WavePropagationBlock.hpp"
#include "catch2/internal/catch_reporter_spec_parser.hpp"
#include "Scenarios/DamBreakScenario.hpp"
#include "Scenarios/ShockRareProblemScenario.hpp"
#include "Tools/Parser.hpp"


RealType testingValues[199][5] = {
  {	5713.47662333434	,	5713.47662333434	,	561.035579567722	,	-561.035579567722	,	5715.84663616131	}	,
{	571.62445882764	,	571.62445882764	,	26.0350337929279	,	-26.0350337929279	,	571.972182499088	}	,
{	10919.4974653193	,	10919.4974653193	,	715.429353052326	,	-715.429353052326	,	10921.6834779026	}	,
{	3311.98029164149	,	3311.98029164149	,	-315.102507984004	,	315.102507984004	,	3310.23239328839	}	,
{	8284.94771414638	,	8284.94771414638	,	-649.967181483735	,	649.967181483735	,	8282.66799072975	}	,
{	3122.41226303613	,	3122.41226303613	,	-127.688831263491	,	127.688831263491	,	3121.68272503948	}	,
{	2041.37507988514	,	2041.37507988514	,	51.2920865529903	,	-51.2920865529903	,	2041.73755127609	}	,
{	9888.56848815517	,	9888.56848815517	,	159.098163380559	,	-159.098163380559	,	9889.07931011395	}	,
{	6091.62884740669	,	6091.62884740669	,	-200.736284404264	,	200.736284404264	,	6090.80772099005	}	,
{	10041.8161014676	,	10041.8161014676	,	-768.141238396169	,	768.141238396169	,	10039.3688760005	}	,
{	10348.2251719418	,	10348.2251719418	,	-34.4016735876231	,	34.4016735876231	,	10348.1171999783	}	,
{	7674.88097420586	,	7674.88097420586	,	-33.8165527676299	,	33.8165527676299	,	7674.75773262451	}	,
{	8019.13325515471	,	8019.13325515471	,	314.015570570004	,	-314.015570570004	,	8020.25286864236	}	,
{	2966.14056774267	,	2966.14056774267	,	84.3908883573005	,	-84.3908883573005	,	2966.6353148893	}	,
{	2445.22408857901	,	2445.22408857901	,	9.72126765607772	,	-9.72126765607772	,	2445.28685564832	}	,
{	8195.99911686647	,	8195.99911686647	,	106.20767856951	,	-106.20767856951	,	8196.37368033924	}	,
{	8027.37052989784	,	8027.37052989784	,	-673.421223876821	,	673.421223876821	,	8024.97096123124	}	,
{	6967.7220076901	,	6967.7220076901	,	-156.834562322191	,	156.834562322191	,	6967.12214407929	}	,
{	6146.91167193657	,	6146.91167193657	,	-345.332918185282	,	345.332918185282	,	6145.50546204528	}	,
{	8600.7540964162	,	8600.7540964162	,	73.5705879926841	,	-73.5705879926841	,	8601.00737860767	}	,
{	10366.1880019933	,	10366.1880019933	,	807.141487499787	,	-807.141487499787	,	10368.7192350498	}	,
{	4165.66497447323	,	4165.66497447323	,	-69.9754179536621	,	69.9754179536621	,	4165.31882808385	}	,
{	10287.2463693327	,	10287.2463693327	,	-1009.07656843889	,	1009.07656843889	,	10284.070178986	}	,
{	4644.31532472814	,	4644.31532472814	,	-389.718000793825	,	389.718000793825	,	4642.48969614061	}	,
{	4509.27548673928	,	4509.27548673928	,	-25.8530844469823	,	25.8530844469823	,	4509.15256703207	}	,
{	1104.23096727096	,	1104.23096727096	,	102.753419436122	,	-102.753419436122	,	1105.21844849679	}	,
{	10796.1682166451	,	10796.1682166451	,	229.251485416849	,	-229.251485416849	,	10796.8726662296	}	,
{	7322.54504023203	,	7322.54504023203	,	503.064180831709	,	-503.064180831709	,	7324.42213281282	}	,
{	7977.17720806927	,	7977.17720806927	,	309.683806990948	,	-309.683806990948	,	7978.28427643192	}	,
{	8003.68528130747	,	8003.68528130747	,	519.089225331465	,	-519.089225331465	,	8005.53790680316	}	,
{	5573.894334066	,	5573.894334066	,	364.40897550712	,	-364.40897550712	,	5575.45282954701	}	,
{	9048.79600111852	,	9048.79600111852	,	181.28599218864	,	-181.28599218864	,	9049.40447458653	}	,
{	6085.02410169603	,	6085.02410169603	,	441.650302857061	,	-441.650302857061	,	6086.83187981762	}	,
{	9091.50882097092	,	9091.50882097092	,	139.6729991654	,	-139.6729991654	,	9091.97651901967	}	,
{	10674.8600245096	,	10674.8600245096	,	714.569841713369	,	-714.569841713369	,	10677.0682913012	}	,
{	1912.24615248598	,	1912.24615248598	,	-188.302782044762	,	188.302782044762	,	1910.87156537471	}	,
{	6411.79026499566	,	6411.79026499566	,	252.180202301305	,	-252.180202301305	,	6412.79581542697	}	,
{	4605.06280866981	,	4605.06280866981	,	-381.275290617638	,	381.275290617638	,	4603.26913231775	}	,
{	529.352552020038	,	529.352552020038	,	-22.8244196250931	,	22.8244196250931	,	529.035866821725	}	,
{	7483.53908840532	,	7483.53908840532	,	-70.7541414039863	,	70.7541414039863	,	7483.27795642807	}	,
{	7032.44660821401	,	7032.44660821401	,	193.698561482068	,	-193.698561482068	,	7033.18408788785	}	,
{	10824.4973130937	,	10824.4973130937	,	41.4705296427158	,	-41.4705296427158	,	10824.6245761902	}	,
{	3102.00842260902	,	3102.00842260902	,	290.688894489171	,	-290.688894489171	,	3103.67502023723	}	,
{	2929.25825417887	,	2929.25825417887	,	-14.1253847117031	,	14.1253847117031	,	2929.17492754052	}	,
{	2979.45878711028	,	2979.45878711028	,	74.0652269892578	,	-74.0652269892578	,	2979.89202551602	}	,
{	1431.19615296922	,	1431.19615296922	,	-22.9562611293236	,	22.9562611293236	,	1431.00242051743	}	,
{	4655.85308314075	,	4655.85308314075	,	-42.1728042849961	,	42.1728042849961	,	4655.65575285663	}	,
{	4176.68414260974	,	4176.68414260974	,	124.076201459946	,	-124.076201459946	,	4177.29713361497	}	,
{	6946.8507755619	,	6946.8507755619	,	636.353083309348	,	-636.353083309348	,	6949.28862991558	}	,
{	7064.54545768316	,	7064.54545768316	,	-336.423967081392	,	336.423967081392	,	7063.26757592342	}	,
{	4936.76221153563	,	4936.76221153563	,	-174.923185175	,	174.923185175	,	4935.96738146941	}	,
{	1629.17566836975	,	1629.17566836975	,	68.8506261622539	,	-68.8506261622539	,	1629.72032867086	}	,
{	8676.73343348858	,	8676.73343348858	,	84.3177626800206	,	-84.3177626800206	,	8677.02244161815	}	,
{	7636.58737848911	,	7636.58737848911	,	-449.166123453894	,	449.166123453894	,	7634.94641282025	}	,
{	6345.19207578104	,	6345.19207578104	,	-13.8113920467163	,	13.8113920467163	,	6345.13671787991	}	,
{	4376.48305258606	,	4376.48305258606	,	-340.161790073339	,	340.161790073339	,	4374.84152694962	}	,
{	5173.24604263913	,	5173.24604263913	,	-350.899959325373	,	350.899959325373	,	5171.68851932994	}	,
{	5363.16012540991	,	5363.16012540991	,	259.390678929799	,	-259.390678929799	,	5364.29104667798	}	,
{	591.504688915256	,	591.504688915256	,	-40.5421960453685	,	40.5421960453685	,	590.972585597679	}	,
{	5119.00884815354	,	5119.00884815354	,	207.264474058445	,	-207.264474058445	,	5119.93379556277	}	,
{	2042.61308048996	,	2042.61308048996	,	-43.9430853797554	,	43.9430853797554	,	2042.30266278206	}	,
{	2784.14637264743	,	2784.14637264743	,	-275.954257349935	,	275.954257349935	,	2782.47685335529	}	,
{	1182.49646779638	,	1182.49646779638	,	-105.034849579774	,	105.034849579774	,	1181.52145697124	}	,
{	8673.29594046416	,	8673.29594046416	,	75.8894751599818	,	-75.8894751599818	,	8673.55611106495	}	,
{	5476.93074071577	,	5476.93074071577	,	398.16700013061	,	-398.16700013061	,	5478.64863400063	}	,
{	5916.80945077868	,	5916.80945077868	,	216.923697056721	,	-216.923697056721	,	5917.70987096572	}	,
{	3835.1509245361	,	3835.1509245361	,	155.552219447192	,	-155.552219447192	,	3835.95292234136	}	,
{	5785.57607878334	,	5785.57607878334	,	-441.110086780736	,	441.110086780736	,	5783.72466099385	}	,
{	3196.60876716961	,	3196.60876716961	,	-28.1549377564015	,	28.1549377564015	,	3196.44977712745	}	,
{	2240.78676621493	,	2240.78676621493	,	-88.2825225247545	,	88.2825225247545	,	2240.191363086	}	,
{	7430.87597651364	,	7430.87597651364	,	645.781046897183	,	-645.781046897183	,	7433.26800158005	}	,
{	10707.3917058913	,	10707.3917058913	,	141.656715152265	,	-141.656715152265	,	10707.8287902343	}	,
{	3713.8579976971	,	3713.8579976971	,	-308.654875120846	,	308.654875120846	,	3712.24111425615	}	,
{	3530.2496319245	,	3530.2496319245	,	-180.556023943811	,	180.556023943811	,	3529.27946842766	}	,
{	8365.69410297429	,	8365.69410297429	,	49.6043475057453	,	-49.6043475057453	,	8365.86725855561	}	,
{	5534.2678398853	,	5534.2678398853	,	-111.564415703949	,	111.564415703949	,	5533.78904256495	}	,
{	2904.37639627864	,	2904.37639627864	,	-60.2249211084068	,	60.2249211084068	,	2904.01961508947	}	,
{	5658.93399158661	,	5658.93399158661	,	-340.045239125247	,	340.045239125247	,	5657.49085582105	}	,
{	311.49275899697	,	311.49275899697	,	-27.6688351732343	,	27.6688351732343	,	310.992427441203	}	,
{	6837.63014722891	,	6837.63014722891	,	545.268372922182	,	-545.268372922182	,	6839.73565295485	}	,
{	4077.57126083754	,	4077.57126083754	,	217.879777181019	,	-217.879777181019	,	4078.66071921354	}	,
{	5315.52744029907	,	5315.52744029907	,	391.512757453372	,	-391.512757453372	,	5317.24208146617	}	,
{	6055.18063320582	,	6055.18063320582	,	-553.945443240412	,	553.945443240412	,	6052.90800609394	}	,
{	4330.81724506685	,	4330.81724506685	,	357.552090766213	,	-357.552090766213	,	4332.5521008145	}	,
{	6145.7169414063	,	6145.7169414063	,	597.037318141529	,	-597.037318141529	,	6148.1487178411	}	,
{	4444.23105635235	,	4444.23105635235	,	-7.38322207587804	,	7.38322207587804	,	4444.19569635295	}	,
{	10171.623095765	,	10171.623095765	,	337.344384830209	,	-337.344384830209	,	10172.691056415	}	,
{	5806.00708279931	,	5806.00708279931	,	69.2252804771011	,	-69.2252804771011	,	5806.29714882449	}	,
{	10808.7189126235	,	10808.7189126235	,	630.714392033299	,	-630.714392033299	,	10810.6559169046	}	,
{	6386.94344312262	,	6386.94344312262	,	17.0878900443267	,	-17.0878900443267	,	6387.01170976803	}	,
{	10434.2391422044	,	10434.2391422044	,	-982.883018174748	,	982.883018174748	,	10431.167257109	}	,
{	4474.17500423792	,	4474.17500423792	,	-299.96560305739	,	299.96560305739	,	4472.7433250111	}	,
{	9033.06482206632	,	9033.06482206632	,	799.733483285577	,	-799.733483285577	,	9035.75156118497	}	,
{	1245.92050891592	,	1245.92050891592	,	82.11296788026	,	-82.11296788026	,	1246.6633514849	}	,
{	3942.15882232062	,	3942.15882232062	,	-131.848290449332	,	131.848290449332	,	3941.48839072256	}	,
{	10102.1976300379	,	10102.1976300379	,	435.222149075954	,	-435.222149075954	,	10103.5801882074	}	,
{	2548.63347361096	,	2548.63347361096	,	-67.9443362531069	,	67.9443362531069	,	2548.20379200815	}	,
{	7903.24585380563	,	7903.24585380563	,	-481.112525624277	,	481.112525624277	,	7901.51808481083	}	,
{	9555.94874654121	,	9555.94874654121	,	-667.220479492637	,	667.220479492637	,	9553.76966642513	}	,
{	163.991371776958	,	163.991371776958	,	-10.1416767606141	,	10.1416767606141	,	163.73861819196	}	,
{	2448.34398945746	,	2448.34398945746	,	198.459586016236	,	-198.459586016236	,	2449.62472107847	}	,
{	8884.48643154005	,	8884.48643154005	,	-438.405846276697	,	438.405846276697	,	8883.00149627531	}	,
{	9584.03276435661	,	9584.03276435661	,	-548.761180554832	,	548.761180554832	,	9582.2431705909	}	,
{	6462.47447365157	,	6462.47447365157	,	384.501486190519	,	-384.501486190519	,	6464.00165197733	}	,
{	10473.3158651195	,	10473.3158651195	,	-721.426830502574	,	721.426830502574	,	10471.0652960145	}	,
{	10013.7657981472	,	10013.7657981472	,	-492.172633707463	,	492.172633707463	,	10012.1955538781	}	,
{	548.770506664454	,	548.770506664454	,	44.744904099505	,	-44.744904099505	,	549.380512915138	}	,
{	5830.79666473391	,	5830.79666473391	,	129.297080833392	,	-129.297080833392	,	5831.33729497372	}	,
{	7099.67729831593	,	7099.67729831593	,	358.711874938399	,	-358.711874938399	,	7101.03659021928	}	,
{	8681.4436445793	,	8681.4436445793	,	619.477759929769	,	-619.477759929769	,	8683.56650668576	}	,
{	7266.60537955954	,	7266.60537955954	,	356.860954421561	,	-356.860954421561	,	7267.94203265889	}	,
{	7974.35070593481	,	8378.34112420599	,	-185.7324996464	,	-322.825608309196	,	8175.31225828047	}	,
{	5330.24427110309	,	5771.19171833003	,	141.928726365367	,	-36.4276880281812	,	5548.90279156106	}	,
{	3739.15719435632	,	4041.67755955957	,	-193.580699425459	,	-162.4374155231	,	3888.82036603159	}	,
{	5799.95305849316	,	5541.99824069089	,	326.663076356645	,	271.255005641637	,	5670.3277077343	}	,
{	1402.39743907098	,	1878.05421493087	,	32.9986020820494	,	48.6511396197193	,	1631.28898436806	}	,
{	6381.50294014365	,	6198.73450242691	,	-209.695510799193	,	20.0262550086908	,	6289.32897464649	}	,
{	1644.43072715937	,	1957.22266657384	,	152.35181956124	,	697.728467320789	,	1795.58340856224	}	,
{	6144.0765190046	,	6341.50227127248	,	379.973506477461	,	96.8711176387911	,	6242.98533220252	}	,
{	7161.43689029458	,	6930.88985011389	,	251.03383395008	,	100.175991745293	,	7045.96644619481	}	,
{	7876.22578338104	,	7965.8070961724	,	193.45847021197	,	165.196027465718	,	7921.00738582347	}	,
{	7735.56172051487	,	8068.60880432805	,	-720.375168070586	,	-701.44794772533	,	7901.11653212599	}	,
{	7096.52372976627	,	6960.30562242909	,	-236.628818785116	,	-530.718695799757	,	7028.82357697016	}	,
{	6375.30895351502	,	6585.10312726155	,	-424.396501555571	,	-701.578847030344	,	6480.29385311504	}	,
{	1756.95732440882	,	1595.2421617927	,	3.85881218419113	,	56.6381808305191	,	1674.89741050011	}	,
{	6498.16455026264	,	6044.74010832747	,	-25.230602016551	,	-17.456510017819	,	6269.37603241321	}	,
{	7385.26417348412	,	7648.81755838673	,	-157.12356341955	,	-351.979122012221	,	7516.80380742952	}	,
{	1761.9996754683	,	2000.48895567145	,	49.1435908754351	,	-64.1641853818221	,	1879.74434574932	}	,
{	7974.67432431474	,	8415.70748480242	,	758.364676341084	,	178.79732872681	,	8194.76671992716	}	,
{	7157.4327487356	,	6877.03173310855	,	159.245171929544	,	364.634521762778	,	7016.11776851263	}	,
{	5146.29719940019	,	4981.80532159088	,	208.17976900283	,	592.53948403162	,	5062.82473223304	}	,
{	4377.63110394409	,	4280.71297634824	,	143.656306855232	,	196.907592720871	,	4328.89768072766	}	,
{	1448.53009956638	,	1556.4885301978	,	-35.1368905674357	,	-289.882736651273	,	1503.02317912405	}	,
{	6459.19646710806	,	6105.90624173497	,	306.658069550706	,	46.1150336562201	,	6281.8078636993	}	,
{	7811.01901063273	,	7702.94562034965	,	-476.442690857279	,	-175.858410926301	,	7756.35148692271	}	,
{	5463.80137340586	,	5178.40724170218	,	-212.911447082995	,	-613.330186975679	,	5321.06788457952	}	,
{	7076.53488840849	,	7082.76651086513	,	-681.329264636154	,	-322.717479072213	,	7078.96915060741	}	,
{	8765.58717365587	,	8696.92655862118	,	-847.993340809229	,	-530.551711249976	,	8730.69003089107	}	,
{	8842.11421446958	,	9149.55454627514	,	-774.102569500919	,	-1044.22432171887	,	8995.57796098548	}	,
{	7493.35993060686	,	7468.64345419341	,	657.082467761797	,	1212.9966146518	,	7479.96488091067	}	,
{	4176.04195901897	,	4595.0800132221	,	284.128149513453	,	363.684319405791	,	4382.91677714777	}	,
{	10668.3716763135	,	10548.4696257684	,	-1061.61844963879	,	-522.796769222089	,	10607.5146029333	}	,
{	1654.01634274536	,	1631.12975241698	,	-120.320196326499	,	-574.789540373082	,	1644.36282771075	}	,
{	7524.6885613229	,	8015.51352848373	,	-49.3723852874844	,	-58.5748629921464	,	7768.16160672618	}	,
{	9840.01616154974	,	9510.76822385257	,	885.515630309891	,	795.913385792397	,	9674.78864075935	}	,
{	447.582818586679	,	447.361479352525	,	-0.684521344809949	,	-233.030168430888	,	449.227718799941	}	,
{	622.233649647338	,	863.224664904597	,	-11.4361456646591	,	11.1072263327617	,	737.511173238566	}	,
{	8149.03910262315	,	8420.5756624638	,	805.070409822835	,	41.5820262396249	,	8285.6131000507	}	,
{	10566.1202299568	,	10461.8040216731	,	261.663824272276	,	197.067077346037	,	10513.9944058158	}	,
{	1990.05998147562	,	2271.56954579869	,	-17.1701553345212	,	1.83264937490457	,	2128.38850838295	}	,
{	1156.10419419924	,	1004.73502151932	,	-91.931775352958	,	-193.57256044241	,	1079.66742917547	}	,
{	5312.42749624784	,	4906.6954141584	,	-185.335444636274	,	-92.729186978431	,	5107.34938092565	}	,
{	6307.71144946989	,	6143.29287026366	,	-490.512901803315	,	-217.527038307196	,	6224.69661612617	}	,
{	2971.1569517052	,	2560.84935598228	,	246.068485901051	,	706.551553074148	,	2760.52034312655	}	,
{	5803.08334779332	,	5742.07438768704	,	-403.237547268226	,	-95.689915032737	,	5771.89787832424	}	,
{	10401.9614675803	,	10139.5475054462	,	72.5761079998103	,	141.794375477153	,	10270.2210637252	}	,
{	5176.10343616817	,	5280.2863984073	,	-189.727605728802	,	-96.8419227510261	,	5227.85352611475	}	,
{	5081.71851879364	,	5493.746061689	,	412.22043726035	,	663.184610380866	,	5285.25049021932	}	,
{	6742.90890478324	,	6977.83585393405	,	-564.510409882318	,	-612.938931407001	,	6859.92240571341	}	,
{	5865.23280875124	,	5801.63330615899	,	-560.710803056739	,	-405.363314809717	,	5833.07598348896	}	,
{	7184.59705528887	,	7018.70553537477	,	714.394950139464	,	520.717864825874	,	7101.74815552339	}	,
{	9531.47791002599	,	9207.10101904012	,	-91.1921243094263	,	213.686013684487	,	9368.07880010276	}	,
{	10307.4528646427	,	10215.5642541887	,	-164.480545841173	,	64.6062270768451	,	10261.0967724483	}	,
{	2618.20773018214	,	2295.15701373766	,	-220.350468934094	,	-925.00750036286	,	2456.51121992305	}	,
{	8236.94091835831	,	7814.66242570034	,	-212.373239641195	,	-91.4524007291314	,	8024.2045186606	}	,
{	5732.56735232835	,	5955.35025387063	,	-515.834346782257	,	-414.814647466674	,	5843.17797125567	}	,
{	2630.89929611814	,	2484.36023531958	,	-49.970009465035	,	51.2099874906958	,	2556.78237447326	}	,
{	7955.04803325477	,	8422.16076514433	,	362.411798603493	,	154.976772542686	,	8187.32185581962	}	,
{	3821.12753908231	,	3847.31996245916	,	-359.694709060758	,	-388.410838032382	,	3834.28000648417	}	,
{	4524.63031633735	,	4169.67927717065	,	-253.013754655226	,	-174.80417546677	,	4345.18123716484	}	,
{	9742.16454004342	,	9371.28391158714	,	204.56954478939	,	56.2578965025756	,	9556.05524805754	}	,
{	10246.5929307951	,	9785.10572766033	,	294.469247946166	,	1.75262291673789	,	10014.9705986251	}	,
{	1468.69486515749	,	1847.9649955781	,	-3.75302865541748	,	0.796848779750999	,	1652.74753165457	}	,
{	728.782886649836	,	447.856091539225	,	40.2686329347529	,	132.482014823116	,	578.461078679143	}	,
{	5279.13445880874	,	5274.63758398329	,	-295.365122907002	,	-59.4451297771181	,	5276.36767136231	}	,
{	1548.43259640478	,	1622.08062141502	,	105.76261916967	,	35.3299041795856	,	1585.33745911694	}	,
{	8479.06858998477	,	8740.47503698123	,	-490.326166074563	,	-65.7022093103782	,	8608.52914476803	}	,
{	9447.88070862327	,	9099.69861502925	,	433.911107285438	,	207.989393821097	,	9273.32429176862	}	,
{	2978.55801059486	,	2487.37681024032	,	77.9235691548133	,	461.885739552124	,	2726.01299915876	}	,
{	10807.6074536704	,	10498.4476352327	,	42.3928582414648	,	90.4206292507764	,	10652.3879472974	}	,
{	4795.92214195069	,	5151.67170522392	,	-248.795788131418	,	-809.472443947674	,	4973.37988066849	}	,
{	5361.73893281587	,	5143.86951293882	,	-392.076820052504	,	-186.890247227792	,	5251.8115325066	}	,
{	7592.5717649018	,	8092.49018261807	,	218.417518027122	,	156.153123021249	,	7840.66053729504	}	,
{	213.589908518515	,	421.063298497683	,	1.07695329324999	,	-37.9771051844949	,	308.223163613037	}	,
{	3307.57843673367	,	3238.42294853421	,	-324.061261551864	,	-22.7562273287136	,	3272.07863814713	}	,
{	5400.48324445944	,	4983.30227810934	,	-308.201241438755	,	-161.891177064823	,	5189.49806958675	}	,
{	7138.04547627244	,	6872.92410985363	,	458.628198447107	,	312.424884691857	,	7005.10649080574	}	,
{	9309.79063792168	,	8910.16852290333	,	147.722632504479	,	176.616661358784	,	9108.81902216451	}	,
{	5617.09911050652	,	5136.24756867765	,	-391.97757479558	,	-837.631656595541	,	5375.05277067871	}	,
{	10157.062550797	,	10189.946237453	,	-855.62081862069	,	-632.150958877371	,	10173.1402588639	}	,
{	9363.07979812313	,	9538.62297895522	,	-77.4908814471437	,	-402.071502145219	,	9451.17296172589	}	,
{	5384.1470565159	,	5278.78049224754	,	-197.032265108688	,	-288.094111701723	,	5331.54296786159	}	,
{	5115.36211746776	,	5376.28116063492	,	354.717707681672	,	425.17914188916	,	5244.89397179487	}	,
{	5119.91736026089	,	4620.58157031285	,	-292.21882734938	,	-314.051326341159	,	4867.13729952148	}	,
{	9552.3573724044	,	9824.5894625536	,	859.929613868065	,	402.674883191933	,	9688.76453222437	}	,
{	3976.68980807938	,	4196.46282226949	,	-7.20828440698046	,	355.596948396162	,	4084.95067480158	}	,
{	2978.46957837161	,	3175.75480018453	,	28.9780137848864	,	58.6135637486702	,	3076.23934885736	}	,
{	9545.14989680079	,	9506.81392410783	,	265.062048095803	,	87.0646144266632	,	9526.26224357462	}	,
{	5798.368717875	,	5772.37015474317	,	234.061775960298	,	599.848252275974	,	5784.5905106763	}
};



TEST_CASE("testing the dam-break scenario", "[DamBreakScenario]"){
  SECTION("Test the Middle State") {

    for(int i = 0; i<3; i++){
      unsigned int size = 1000;

      RealType* h = new RealType[size + 2];
      RealType* hu = new RealType[size + 2];
      unsigned int n = 199;
      for (unsigned int k = 0; k < n; k++) {
        for (unsigned int j = 0; j < size + 2; j++) {
          if (j <= size/2) {
            h[j] = testingValues[k][0];
            hu[j] = testingValues[k][2];
          } else {
            h[j] = testingValues[k][1];
            hu[j] = testingValues[k][3];
          }
        }
        Blocks::WavePropagationBlock wavePropagation(h, hu, size, 1000.0/size);
        RealType hL, hR;
        hL = testingValues[k][0];
        hR = testingValues[k][1];

        for (unsigned int i = 0; i < 1000; i++) {
          wavePropagation.setOutflowBoundaryConditions();
          RealType maxTimeStep = wavePropagation.computeNumericalFluxes();
          wavePropagation.updateUnknowns(maxTimeStep);
        }
        REQUIRE(h[size/2] != 0.0);
        RealType margin;
        if (hL == hR) {
          margin = 0.001;
        } else {
          margin = 0.001*std::fabs(hL-hR);
        }
        std::cout << margin << ":" << h[size/2] << ":" << testingValues[k][4] << std::endl;
        REQUIRE_THAT(h[size/2], Catch::Matchers::WithinAbs(testingValues[k][4], margin));
      }

      delete[] h;
      delete[] hu;
    }
  }

}

